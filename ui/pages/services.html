<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Service Health - Playwright DevOps</title>
    <link rel="stylesheet" href="../assets/style.css" />
  </head>
  <body
    data-page="services"
    data-page-title="Service Health"
    data-page-subtitle="Service mesh visibility with blast radius awareness."
    data-signals-src="../data/release-signals.json"
    data-signals-poll="15000"
  >
    <div class="atmosphere">
      <span class="orb orb-1"></span>
      <span class="orb orb-2"></span>
      <span class="orb orb-3"></span>
      <span class="grid-glow"></span>
    </div>

    <div class="app-shell">
      <aside class="sidebar" data-component="nav" data-component-src="../components/nav.html"></aside>

      <div class="content">
        <header class="topbar" data-component="header" data-component-src="../components/header.html"></header>

        <main class="page-content">
          <section class="hero compact">
            <div class="hero-copy">
              <span class="eyebrow">Blast Radius View</span>
              <h2>Service Health Matrix</h2>
              <p>Monitor upstream and downstream dependencies. Failures are isolated to this page.</p>
              <div class="hero-badges">
                <span class="pill">Telemetry: Live</span>
                <span class="pill">Isolation: Enabled</span>
              </div>
            </div>
            <div class="hero-actions">
              <div class="hero-meta">
                <div class="meta-block">
                  <span class="meta-label">Critical Services</span>
                  <span class="meta-value" id="criticalCount">4</span>
                </div>
                <div class="meta-block">
                  <span class="meta-label">Degraded</span>
                  <span class="meta-value" id="degradedCount">1</span>
                </div>
                <div class="meta-block">
                  <span class="meta-label">Last Update</span>
                  <span class="meta-value" id="serviceUpdated">just now</span>
                </div>
              </div>
            </div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Service Status</h3>
                <p>Simulated telemetry feed with graceful degradation handling.</p>
              </div>
              <div class="panel-actions">
                <button class="btn ghost" id="toggleServiceFailure">Simulate Failure</button>
                <button class="btn primary" id="retryServiceLoad">Reload Feed</button>
              </div>
            </div>
            <div class="status-banner" id="serviceBanner">Telemetry feed healthy.</div>
            <div class="service-grid" id="serviceGrid"></div>
            <div class="empty-state" id="serviceEmpty" hidden>
              <h4>Service feed unavailable</h4>
              <p>The dashboard remains online. Retry to restore service telemetry.</p>
            </div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Service Signals &amp; Performance</h3>
                <p>Release signal snapshots mapped to service routes and performance checks.</p>
              </div>
              <div class="panel-actions">
                <span class="tag" id="serviceSignalBadge">No Data</span>
                <button class="btn ghost" id="refreshServiceSignals">Refresh</button>
                <button class="btn ghost" id="simulatePerfRegression">Simulate Regression</button>
                <button class="btn primary" id="clearPerfRegression">Clear</button>
              </div>
            </div>
            <div class="table-wrap">
              <table class="data-table" id="serviceSignalTable">
                <thead>
                  <tr>
                    <th>Scenario</th>
                    <th>Path</th>
                    <th>Status</th>
                    <th>Avg</th>
                    <th>P95</th>
                    <th>RPS</th>
                    <th>Error</th>
                  </tr>
                </thead>
                <tbody id="serviceSignalRows">
                  <tr>
                    <td colspan="7">No signal data loaded.</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="note-strip" id="serviceSignalNote">Signals updated: N/A</div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Database Dependencies</h3>
                <p>Storage tier health and saturation for release-critical systems.</p>
              </div>
              <span class="tag stable">Stable</span>
            </div>
            <div class="qa-grid">
              <div class="qa-card">
                <span class="qa-label">Primary Cluster</span>
                <span class="qa-value">Online</span>
              </div>
              <div class="qa-card">
                <span class="qa-label">Replica Lag</span>
                <span class="qa-value">1.4 s</span>
              </div>
              <div class="qa-card">
                <span class="qa-label">Connection Saturation</span>
                <span class="qa-value">68%</span>
              </div>
              <div class="qa-card">
                <span class="qa-label">P95 Query</span>
                <span class="qa-value">22 ms</span>
              </div>
              <div class="qa-card">
                <span class="qa-label">Cache Hit Rate</span>
                <span class="qa-value">96%</span>
              </div>
              <div class="qa-card">
                <span class="qa-label">Write Errors</span>
                <span class="qa-value">0.02%</span>
              </div>
            </div>
            <div class="note-strip">
              <span>Failover: ready</span>
              <span>Backups: every 15m</span>
            </div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Blast Radius and Isolation</h3>
                <p>Failure domains are scoped to avoid total outage.</p>
              </div>
              <span class="tag">Isolated</span>
            </div>
            <div class="blast-grid">
              <div class="blast-card">
                <h4>Customer APIs</h4>
                <p>Protected by circuit breakers and autoscale policies.</p>
                <span class="status-pill running">Healthy</span>
              </div>
              <div class="blast-card">
                <h4>Internal Services</h4>
                <p>Degraded components trigger fallback response plans.</p>
                <span class="status-pill warn">Degraded</span>
              </div>
              <div class="blast-card">
                <h4>Observability</h4>
                <p>Metrics still available even if service health feed fails.</p>
                <span class="status-pill running">Online</span>
              </div>
            </div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Monitoring &amp; SLO Coverage</h3>
                <p>Live budget health for availability, latency, and trace coverage.</p>
              </div>
              <div class="panel-actions">
                <span class="tag stable" id="sloStatusBadge">Healthy</span>
                <button class="btn ghost" id="simulateBudgetBurn">Simulate Budget Burn</button>
                <button class="btn primary" id="resetSlo">Reset SLO</button>
              </div>
            </div>
            <div class="slo-grid">
              <div class="slo-card">
                <div class="slo-title">
                  <span>Availability</span>
                  <span class="status-chip success" id="sloAvailabilityStatus">On Target</span>
                </div>
                <div class="slo-value" id="sloAvailability">99.95%</div>
                <div class="slo-meta">Target: 99.9%</div>
              </div>
              <div class="slo-card">
                <div class="slo-title">
                  <span>P95 Latency</span>
                  <span class="status-chip success" id="sloLatencyStatus">On Target</span>
                </div>
                <div class="slo-value" id="sloLatency">180 ms</div>
                <div class="slo-meta">Target: &lt; 250 ms</div>
              </div>
              <div class="slo-card">
                <div class="slo-title">
                  <span>Error Budget</span>
                  <span class="status-chip success" id="sloBudgetStatus">Healthy</span>
                </div>
                <div class="slo-value" id="sloBudget">14%</div>
                <div class="slo-meta">Minimum: 10%</div>
              </div>
              <div class="slo-card">
                <div class="slo-title">
                  <span>Trace Coverage</span>
                  <span class="status-chip success" id="sloTracingStatus">On Target</span>
                </div>
                <div class="slo-value" id="sloTracing">96%</div>
                <div class="slo-meta">Target: 90%</div>
              </div>
            </div>
            <div class="slo-summary" id="sloSummary">Error budget stable across services.</div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>EU Compliance &amp; ISO Standards</h3>
                <p>Audit readiness for ISO controls and EU data residency.</p>
              </div>
              <div class="panel-actions">
                <button class="btn ghost" id="runIsoAudit">Run ISO Audit</button>
                <div class="select-control">
                  <label for="residencySelect">Data Residency</label>
                  <select id="residencySelect">
                    <option value="ap-southeast-1">APAC (ap-southeast-1)</option>
                    <option value="eu-west-1">EU West (eu-west-1)</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="compliance-grid">
              <div class="compliance-card">
                <div>
                  <h4>ISO 27001</h4>
                  <p>ISMS controls verified.</p>
                </div>
                <span class="status-chip success" id="iso27001Status">Compliant</span>
              </div>
              <div class="compliance-card">
                <div>
                  <h4>ISO 27017</h4>
                  <p>Cloud security safeguards validated.</p>
                </div>
                <span class="status-chip success" id="iso27017Status">Compliant</span>
              </div>
              <div class="compliance-card">
                <div>
                  <h4>ISO 9001</h4>
                  <p>Quality management audits passed.</p>
                </div>
                <span class="status-chip success" id="iso9001Status">Compliant</span>
              </div>
              <div class="compliance-card">
                <div>
                  <h4>ISO 22301</h4>
                  <p>Business continuity review.</p>
                </div>
                <span class="status-chip warn" id="iso22301Status">Review</span>
              </div>
              <div class="compliance-card">
                <div>
                  <h4>GDPR</h4>
                  <p>Data protection controls aligned.</p>
                </div>
                <span class="status-chip success" id="gdprStatus">Compliant</span>
              </div>
              <div class="compliance-card">
                <div>
                  <h4>NIS2</h4>
                  <p>Critical infrastructure mapping.</p>
                </div>
                <span class="status-chip warn" id="nis2Status">Review</span>
              </div>
            </div>
            <div class="compliance-summary">
              <span id="residencyBadge">Residency: APAC</span>
              <span id="isoSummary">Audit review in progress.</span>
            </div>
          </section>
        </main>
      </div>
    </div>

    <script src="../assets/app.js" defer></script>
    <script src="../assets/services.js" defer></script>
  </body>
</html>
