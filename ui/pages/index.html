<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Decision and Control Plan</title>
    <link rel="stylesheet" href="../assets/style.css" />
  </head>
  <body
    data-page="dashboard"
    data-page-title="Dashboard"
    data-page-subtitle="Production release control for Playwright CI/CD."
    data-signals-src="../data/release-signals.json"
  >
    <div class="atmosphere">
      <span class="orb orb-1"></span>
      <span class="orb orb-2"></span>
      <span class="orb orb-3"></span>
      <span class="grid-glow"></span>
    </div>

    <div class="app-shell">
      <aside class="sidebar" data-component="nav" data-component-src="../components/nav.html"></aside>

      <div class="content">
        <header class="topbar" data-component="header" data-component-src="../components/header.html"></header>

        <main class="page-content">
          <section class="hero">
            <div class="hero-copy">
              <span class="eyebrow">Production Simulation</span>
              <h2>Decision and Control Plan</h2>
              <p>
                Unified view of CI/CD, infrastructure automation, configuration management, and observability for
                production-like testing.
              </p>
              <div class="hero-badges">
                <span class="pill">Environment: Production</span>
                <span class="pill">Region: ap-southeast-1</span>
                <span class="pill live">Live Simulation</span>
              </div>
            </div>
            <div class="hero-actions">
              <div class="hero-meta">
                <div class="meta-block">
                  <span class="meta-label">Release ID</span>
                  <span class="meta-value" id="buildId">REL-2406</span>
                </div>
                <div class="meta-block">
                  <span class="meta-label">Commit</span>
                  <span class="meta-value code" id="commitHash">c9f2b18</span>
                </div>
                <div class="meta-block">
                  <span class="meta-label">Window</span>
                  <span class="meta-value" id="deployWindow">21:00-23:00 UTC</span>
                </div>
              </div>
              <div class="rbac-panel">
                <span class="rbac-title">RBAC Rules</span>
                <ul>
                  <li>Admin: trigger, pause, approve, rollback, resume</li>
                  <li>Moderator: resume paused release, observe</li>
                  <li>User: read-only</li>
                </ul>
              </div>
            </div>
          </section>

          <section class="grid">
            <div class="panel span-7 pipeline">
              <div class="panel-head">
                <div>
                  <h3>Release Pipeline</h3>
                  <p>Jenkins orchestrates build, Playwright tests, Terraform, and Ansible deploy.</p>
                </div>
                <span class="tag running" id="runState">Running</span>
              </div>
              <ol class="steps">
                <li class="step" data-step="0" data-status="success">
                  <div>
                    <span class="step-title">Source Sync</span>
                    <span class="step-desc">Checkout main from origin</span>
                  </div>
                  <div class="step-meta">
                    <span class="chip">Jenkins</span>
                    <span class="step-status">Success</span>
                  </div>
                </li>
                <li class="step" data-step="1" data-status="success">
                  <div>
                    <span class="step-title">Build Artifact</span>
                    <span class="step-desc">Containerize app and tag image</span>
                  </div>
                  <div class="step-meta">
                    <span class="chip">Jenkins</span>
                    <span class="step-status">Success</span>
                  </div>
                </li>
                <li class="step" data-step="2" data-status="running">
                  <div>
                    <span class="step-title">Playwright Unit Tests</span>
                    <span class="step-desc">Headless tests against staging APIs</span>
                  </div>
                  <div class="step-meta">
                    <span class="chip">Playwright</span>
                    <span class="step-status">Running</span>
                  </div>
                </li>
                <li class="step" data-step="3" data-status="queued">
                  <div>
                    <span class="step-title">Terraform Plan</span>
                    <span class="step-desc">Compute infra drift and plan changes</span>
                  </div>
                  <div class="step-meta">
                    <span class="chip">Terraform</span>
                    <span class="step-status">Queued</span>
                  </div>
                </li>
                <li class="step" data-step="4" data-status="queued">
                  <div>
                    <span class="step-title">Terraform Apply</span>
                    <span class="step-desc">Apply approved infrastructure changes</span>
                  </div>
                  <div class="step-meta">
                    <span class="chip">Terraform</span>
                    <span class="step-status">Queued</span>
                  </div>
                </li>
                <li class="step" data-step="5" data-status="queued">
                  <div>
                    <span class="step-title">Ansible Deploy</span>
                    <span class="step-desc">Configure services and rollout</span>
                  </div>
                  <div class="step-meta">
                    <span class="chip">Ansible</span>
                    <span class="step-status">Queued</span>
                  </div>
                </li>
                <li class="step" data-step="6" data-status="queued">
                  <div>
                    <span class="step-title">Post-Deploy Tests</span>
                    <span class="step-desc">Smoke and regression checks</span>
                  </div>
                  <div class="step-meta">
                    <span class="chip">Playwright</span>
                    <span class="step-status">Queued</span>
                  </div>
                </li>
                <li class="step" data-step="7" data-status="queued">
                  <div>
                    <span class="step-title">Observability Gate</span>
                    <span class="step-desc">Prometheus and Grafana validation</span>
                  </div>
                  <div class="step-meta">
                    <span class="chip">Grafana</span>
                    <span class="step-status">Queued</span>
                  </div>
                </li>
              </ol>
            </div>

            <div class="panel span-5 release">
              <div class="panel-head">
                <div>
                  <h3>Release Command Center</h3>
                  <p>Lifecycle state, approvals, and release controls.</p>
                </div>
                <span class="tag queued" id="releaseStateBadge">Queued</span>
              </div>
              <div class="state-track">
                <div class="state-item" data-state="queued">Queued</div>
                <div class="state-item" data-state="running">Running</div>
                <div class="state-item" data-state="paused">Paused</div>
                <div class="state-item" data-state="blocked">Blocked</div>
                <div class="state-item" data-state="succeeded">Succeeded</div>
                <div class="state-item" data-state="failed">Failed</div>
                <div class="state-item" data-state="rolled-back">Rolled Back</div>
              </div>
              <div class="control-grid">
                <button class="btn primary" id="triggerRun" data-role-allow="admin">Trigger Release</button>
                <button class="btn ghost" id="pauseRelease" data-role-allow="admin">Pause</button>
                <button class="btn ghost" id="resumeRelease" data-role-allow="admin,moderator">Resume</button>
                <button class="btn ghost" id="approveRelease" data-role-allow="admin">Approve</button>
                <button class="btn ghost" id="rejectRelease" data-role-allow="admin">Reject</button>
                <button class="btn danger" id="rollbackRelease" data-role-allow="admin">Rollback</button>
              </div>
              <div class="approval-card">
                <span>Approvals</span>
                <span class="approval-count" id="approvalCount">0/2</span>
              </div>
              <div class="policy-list">
                <div class="policy-item" data-policy="approvals">
                  <span>2 approvals required</span>
                  <span class="policy-status" id="policyApprovals">Pending</span>
                </div>
                <div class="policy-item" data-policy="drift">
                  <span>Terraform drift must be 0</span>
                  <span class="policy-status" id="policyDrift">Passing</span>
                </div>
                <div class="policy-item" data-policy="canary">
                  <span>Canary success required</span>
                  <span class="policy-status" id="policyCanary">Passing</span>
                </div>
              </div>
            </div>

            <div class="panel span-7 incidents">
              <div class="panel-head">
                <div>
                  <h3>Failure & Incident Simulation</h3>
                  <p>Toggle incidents and validate graceful degradation.</p>
                </div>
                <span class="tag" id="incidentBadge">Stable</span>
              </div>
              <div class="incident-grid">
                <div class="incident-block">
                  <h4>Failure Signals</h4>
                  <div class="incident-list">
                    <button class="incident-btn" data-incident="terraformDrift" data-role-allow="admin">Terraform Drift Detected</button>
                    <button class="incident-btn" data-incident="jenkinsQueue" data-role-allow="admin">Jenkins Queue Full</button>
                    <button class="incident-btn" data-incident="jenkinsNode" data-role-allow="admin">Jenkins Node Down</button>
                    <button class="incident-btn" data-incident="serviceUnhealthy" data-role-allow="admin">Service Unhealthy</button>
                    <button class="incident-btn" data-incident="deploymentTimeout" data-role-allow="admin">Deployment Timeout</button>
                    <button class="incident-btn" data-incident="canaryFailed" data-role-allow="admin">Canary Failed</button>
                  </div>
                </div>
                <div class="incident-block">
                  <h4>Recovery Actions</h4>
                  <div class="incident-list">
                    <button class="incident-btn recovery" data-recovery="terraformDrift" data-role-allow="admin">Clear Terraform Drift</button>
                    <button class="incident-btn recovery" data-recovery="jenkinsCapacity" data-role-allow="admin">Restore Jenkins Capacity</button>
                    <button class="incident-btn recovery" data-recovery="serviceHealthy" data-role-allow="admin">Service Healthy Again</button>
                  </div>
                </div>
              </div>
              <div class="incident-summary" id="incidentSummary">0 incidents active</div>
            </div>

            <div class="panel span-5 stack">
              <div class="panel-head">
                <div>
                  <h3>Core System Status</h3>
                  <p>Enterprise health cards for infrastructure and monitoring.</p>
                </div>
                <span class="tag stable" id="coreState">Stable</span>
              </div>
              <div class="stack-grid">
                <article class="stack-card">
                  <div class="stack-title">
                    <span>Jenkins</span>
                    <span class="status-chip success" id="jenkinsStatus">Healthy</span>
                  </div>
                  <p id="jenkinsDetail">Build queue and nodes within capacity.</p>
                  <div class="stack-meta">
                    <span id="jenkinsExecutors">Executors: 6/8</span>
                    <span id="jenkinsQueue">Queue: 0</span>
                  </div>
                </article>
                <article class="stack-card">
                  <div class="stack-title">
                    <span>Terraform</span>
                    <span class="status-chip success" id="terraformStatus">Clean</span>
                  </div>
                  <p id="terraformDetail">No drift detected across modules.</p>
                  <div class="stack-meta">
                    <span id="terraformDrift">Drift: 0 resources</span>
                    <span id="terraformPlan">Plan: ready</span>
                  </div>
                </article>
                <article class="stack-card">
                  <div class="stack-title">
                    <span>Ansible</span>
                    <span class="status-chip success" id="ansibleStatus">Stable</span>
                  </div>
                  <p id="ansibleDetail">Playbook success rate holding steady.</p>
                  <div class="stack-meta">
                    <span id="ansibleRate">Success: 98%</span>
                    <span id="ansibleDeploy">Deploys: 12</span>
                  </div>
                </article>
                <article class="stack-card">
                  <div class="stack-title">
                    <span>Monitoring</span>
                    <span class="status-chip success" id="monitoringStatus">Green</span>
                  </div>
                  <p id="monitoringDetail">Metrics and alerts within thresholds.</p>
                  <div class="stack-meta">
                    <span id="monitoringAlerts">Alerts: 3</span>
                    <span id="monitoringTargets">Targets: 142</span>
                  </div>
                </article>
              </div>
            </div>

            <div class="panel span-7 route-health">
              <div class="panel-head">
                <div>
                  <h3>Route Health</h3>
                  <p>Track navigation, broken routes, and partial failures.</p>
                </div>
                <span class="tag stable" id="routeHealthBadge">Healthy</span>
              </div>
              <div class="route-grid">
                <div class="route-item" data-route="services">
                  <div>
                    <span class="route-name">Services</span>
                    <span class="route-meta">/services.html</span>
                  </div>
                  <div class="route-actions">
                    <span class="status-chip success" data-route-status>Healthy</span>
                    <button class="btn ghost route-toggle" data-route-toggle="services" data-role-allow="admin">Toggle</button>
                  </div>
                </div>
                <div class="route-item" data-route="users">
                  <div>
                    <span class="route-name">Users</span>
                    <span class="route-meta">/users.html</span>
                  </div>
                  <div class="route-actions">
                    <span class="status-chip success" data-route-status>Healthy</span>
                    <button class="btn ghost route-toggle" data-route-toggle="users" data-role-allow="admin">Toggle</button>
                  </div>
                </div>
                <div class="route-item" data-route="permissions">
                  <div>
                    <span class="route-name">Policies</span>
                    <span class="route-meta">/permissions.html</span>
                  </div>
                  <div class="route-actions">
                    <span class="status-chip success" data-route-status>Healthy</span>
                    <button class="btn ghost route-toggle" data-route-toggle="permissions" data-role-allow="admin">Toggle</button>
                  </div>
                </div>
                <div class="route-item" data-route="settings">
                  <div>
                    <span class="route-name">Settings</span>
                    <span class="route-meta">/settings.html</span>
                  </div>
                  <div class="route-actions">
                    <span class="status-chip success" data-route-status>Healthy</span>
                    <button class="btn ghost route-toggle" data-route-toggle="settings" data-role-allow="admin">Toggle</button>
                  </div>
                </div>
              </div>
              <div class="route-summary" id="routeSummary">0 broken routes</div>
            </div>

            <div class="panel span-5 windows">
              <div class="panel-head">
                <div>
                  <h3>Time-based Conditions</h3>
                  <p>Deployment, maintenance, and freeze windows.</p>
                </div>
                <span class="tag" id="windowBadge">On Schedule</span>
              </div>
              <div class="window-grid">
                <div class="window-row" data-window="deployment">
                  <div>
                    <span class="window-name">Deployment Window</span>
                    <span class="window-meta">21:00-23:00 UTC</span>
                  </div>
                  <div class="window-actions">
                    <span class="status-chip success" id="deploymentWindowStatus">Open</span>
                    <button class="btn ghost window-toggle" data-window-toggle="deployment" data-role-allow="admin">Override</button>
                  </div>
                </div>
                <div class="window-row" data-window="maintenance">
                  <div>
                    <span class="window-name">Maintenance Window</span>
                    <span class="window-meta">02:00-03:00 UTC</span>
                  </div>
                  <div class="window-actions">
                    <span class="status-chip warn" id="maintenanceWindowStatus">Inactive</span>
                    <button class="btn ghost window-toggle" data-window-toggle="maintenance" data-role-allow="admin">Override</button>
                  </div>
                </div>
                <div class="window-row" data-window="freeze">
                  <div>
                    <span class="window-name">Freeze Window</span>
                    <span class="window-meta">Weekends UTC</span>
                  </div>
                  <div class="window-actions">
                    <span class="status-chip warn" id="freezeWindowStatus">Inactive</span>
                    <button class="btn ghost window-toggle" data-window-toggle="freeze" data-role-allow="admin">Override</button>
                  </div>
                </div>
              </div>
              <div class="window-note" id="windowNote">Auto schedule in UTC, override for testing.</div>
            </div>

            <div class="panel span-7 metrics">
              <div class="panel-head">
                <div>
                  <h3>Observability Signals</h3>
                  <p>Prometheus metrics rendered into Grafana-style tiles.</p>
                </div>
                <span class="tag" id="alertState">All Clear</span>
              </div>
              <div class="metrics-grid">
                <div class="metric-card">
                  <div class="metric-header">
                    <span>Request Rate</span>
                    <span class="metric-value" id="reqRate">1,240 rpm</span>
                  </div>
                  <canvas class="spark" data-color="#47d7c3"></canvas>
                </div>
                <div class="metric-card">
                  <div class="metric-header">
                    <span>Error Rate</span>
                    <span class="metric-value" id="errRate">0.62%</span>
                  </div>
                  <canvas class="spark" data-color="#ff6f61"></canvas>
                </div>
                <div class="metric-card">
                  <div class="metric-header">
                    <span>P95 Latency</span>
                    <span class="metric-value" id="latency">240 ms</span>
                  </div>
                  <canvas class="spark" data-color="#f6b73c"></canvas>
                </div>
              </div>
              <div class="note-strip">
                <span>Alert routing: On-call primary (APAC)</span>
                <span>Last incident: 12 days ago</span>
              </div>
            </div>

            <div class="panel span-5 infra">
              <div class="panel-head">
                <div>
                  <h3>IaC and Config</h3>
                  <p>Terraform modules and Ansible playbooks in the current release.</p>
                </div>
                <span class="tag">Ready</span>
              </div>
              <div class="infra-grid">
                <div class="infra-block">
                  <h4>Terraform Modules</h4>
                  <ul>
                    <li>vpc-core</li>
                    <li>eks-bluegreen</li>
                    <li>rds-postgres-ha</li>
                    <li>cdn-edge-cache</li>
                    <li>iam-policy-pack</li>
                  </ul>
                </div>
                <div class="infra-block">
                  <h4>Ansible Playbooks</h4>
                  <ul>
                    <li>baseline-hardening</li>
                    <li>app-config-rollout</li>
                    <li>worker-drain-replace</li>
                    <li>nginx-canary</li>
                    <li>log-forwarding</li>
                  </ul>
                </div>
                <div class="infra-block">
                  <h4>Promotion Gates</h4>
                  <ul>
                    <li>Security scan: passed</li>
                    <li>Terraform plan: pending approval</li>
                    <li>Smoke tests: queued</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="panel span-7 db">
              <div class="panel-head">
                <div>
                  <h3>Database Telemetry</h3>
                  <p>Connection pools, replication lag, and query health.</p>
                </div>
                <span class="tag stable">Stable</span>
              </div>
              <div class="qa-grid">
                <div class="qa-card">
                  <span class="qa-label">Primary</span>
                  <span class="qa-value">postgres-prod-01</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">Replicas</span>
                  <span class="qa-value">2 healthy</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">Pool Saturation</span>
                  <span class="qa-value">68%</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">P95 Query</span>
                  <span class="qa-value">22 ms</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">Replication Lag</span>
                  <span class="qa-value">1.4 s</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">Deadlocks</span>
                  <span class="qa-value">0</span>
                </div>
              </div>
              <div class="note-strip">
                <span>Failover: standby-ready</span>
                <span>Backups: 15m RPO</span>
                <span>Retention: 30d</span>
              </div>
            </div>

            <div class="panel span-5 traces">
              <div class="panel-head">
                <div>
                  <h3>Trace Signals</h3>
                  <p>Distributed tracing snapshots for release validation.</p>
                </div>
                <span class="tag">Sampling 12%</span>
              </div>
              <div class="qa-grid">
                <div class="qa-card">
                  <span class="qa-label">Span Error Rate</span>
                  <span class="qa-value">0.6%</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">P99 Span</span>
                  <span class="qa-value">480 ms</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">Trace Backlog</span>
                  <span class="qa-value">42</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">DB Span Share</span>
                  <span class="qa-value">31%</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">Top Service</span>
                  <span class="qa-value">api-gateway</span>
                </div>
                <div class="qa-card">
                  <span class="qa-label">Trace Budget</span>
                  <span class="qa-value">Healthy</span>
                </div>
              </div>
              <ul class="trace-list">
                <li>[trace] /checkout 420ms: api-gateway → payments → postgres</li>
                <li>[trace] /deploy 310ms: pipeline → ansible → config-store</li>
                <li>[trace] /login 180ms: edge → auth → redis</li>
                <li>[trace] /health 90ms: mesh → services → prometheus</li>
              </ul>
            </div>

            <div class="panel span-7 logs">
              <div class="panel-head">
                <div>
                  <h3>System Log</h3>
                  <p>Release events, approvals, and test checkpoints.</p>
                </div>
                <span class="tag">Streaming</span>
              </div>
              <ul class="log-list" id="logList">
                <li>[21:12:04] Release REL-2406 queued by Jenkins pipeline.</li>
                <li>[21:12:18] CI signal snapshot pulled into release board.</li>
                <li>[21:12:42] Build artifact created and pushed to registry.</li>
                <li>[21:13:05] Schema drift check passed for primary database.</li>
                <li>[21:13:10] Playwright unit tests started for API suite.</li>
                <li>[21:13:22] Replica lag steady at 1.4s across read replicas.</li>
                <li>[21:13:40] Trace sampling stable at 12% for checkout flow.</li>
                <li>[21:13:55] Terraform plan generated with 2 changes pending review.</li>
                <li>[21:14:06] Canary checks queued for region ap-southeast-1.</li>
                <li>[21:14:22] Grafana dashboards refreshed for release watch.</li>
                <li>[21:14:40] Cache hit rate stabilized at 96% for edge tier.</li>
                <li>[21:15:02] Release approvals pending: 0/2 confirmed.</li>
                <li>[21:15:20] Error budget steady, no active incidents.</li>
              </ul>
            </div>

            <div class="panel span-5 qa">
              <div class="panel-head">
                <div>
                  <h3>Release Signals</h3>
                  <p>Read-only test health and performance gates from CI.</p>
                </div>
                <div class="panel-actions">
                  <span class="tag" id="qaState">UI: No Data</span>
                  <span class="tag" id="perfState">Perf: No Data</span>
                </div>
              </div>
              <div class="signal-stack">
                <div class="signal-block">
                  <div class="signal-head">
                    <span class="signal-title">UI Test Health</span>
                    <span class="signal-meta" id="uiSummaryMeta">Updated: N/A</span>
                  </div>
                  <div class="qa-grid">
                    <div class="qa-card">
                      <span class="qa-label">Total Tests</span>
                      <span class="qa-value" id="qaTotal">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Passed</span>
                      <span class="qa-value" id="qaPassed">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Failed</span>
                      <span class="qa-value" id="qaFailed">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Skipped</span>
                      <span class="qa-value" id="qaSkipped">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Flaky</span>
                      <span class="qa-value" id="qaFlaky">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Duration</span>
                      <span class="qa-value" id="qaDuration">N/A</span>
                    </div>
                  </div>
                </div>
                <div class="signal-block">
                  <div class="signal-head">
                    <span class="signal-title">Performance Regression</span>
                    <span class="signal-meta" id="perfSummaryMeta">Updated: N/A</span>
                  </div>
                  <div class="qa-grid">
                    <div class="qa-card">
                      <span class="qa-label">Scenarios</span>
                      <span class="qa-value" id="perfScenarioTotal">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Failed</span>
                      <span class="qa-value" id="perfScenarioFailed">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Worst Avg</span>
                      <span class="qa-value" id="perfWorstAvg">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Worst P95</span>
                      <span class="qa-value" id="perfWorstP95">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Min RPS</span>
                      <span class="qa-value" id="perfMinRps">N/A</span>
                    </div>
                    <div class="qa-card">
                      <span class="qa-label">Max Error</span>
                      <span class="qa-value" id="perfErrorRate">N/A</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="qa-footer" id="signalFooter">Signals updated: N/A</div>
            </div>
          </section>
        </main>
      </div>
    </div>

    <script src="../assets/app.js" defer></script>
    <script src="../assets/dashboard/context.js" defer></script>
    <script src="../assets/dashboard/release.js" defer></script>
    <script src="../assets/dashboard/incidents.js" defer></script>
    <script src="../assets/dashboard/routes.js" defer></script>
    <script src="../assets/dashboard/windows.js" defer></script>
    <script src="../assets/dashboard/metrics.js" defer></script>
    <script src="../assets/dashboard/signals.js" defer></script>
    <script src="../assets/dashboard/init.js" defer></script>
  </body>
</html>
